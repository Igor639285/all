# Мониторинг ПК через Termux (localhost на ПК + веб-дашборд на телефоне)

В проекте 2 основные части:

- `pc_monitor_server.py` — запускается **на ПК**, слушает только `127.0.0.1`.
- `termux_monitor_client.py` (или обертка `termux_monitor_client.sh`) — запускается **в Termux**, поднимает локальный сайт с графиками, таблицами и сводками.

---

## 1) Настройка и запуск на ПК

Запуск сервера мониторинга:

```bash
python3 pc_monitor_server.py --port 8765 --token "my-secret-token"
```

Что важно:

- Сервер намеренно слушает только `localhost`, как вы и просили.
- Для доступа с телефона используйте свою переадресацию/туннель (ngrok/cloudflared/reverse proxy/router forwarding и т.д.), который публикует `http://127.0.0.1:8765` наружу.

Проверка локально на ПК:

```bash
curl -H "X-Monitor-Token: my-secret-token" http://127.0.0.1:8765/status
```

---

## 2) Полная инструкция для Termux

### Установка зависимостей

```bash
pkg update
pkg install -y python git
```

### Клонирование/копирование скриптов

```bash
git clone <ВАШ_РЕПО_URL>
cd all
chmod +x termux_monitor_client.sh termux_monitor_client.py
```

### Запуск клиента (интерактивный режим)

```bash
./termux_monitor_client.sh
```

Скрипт спросит:

1. Адрес туннеля/переадресации (например `https://abc123.ngrok-free.app` или `http://1.2.3.4:9999`).
2. Токен (если вы запускали сервер с `--token`).
3. Интервал опроса в секундах.

После запуска вы увидите ссылку вида:

```text
http://127.0.0.1:8088
```

Откройте её в браузере на телефоне (Chrome/Firefox) — это локальный дашборд Termux.

### Что есть в веб-дашборде

- Карточки с текущими значениями: CPU, RAM, Disk, uptime.
- Живой график (линии CPU/RAM/Disk по истории опроса).
- Таблица со сводкой: хост, платформа, RAM used/total, Disk used/total, время сервера.
- Индикация ошибок подключения к вашему туннелю.

### Запуск без интерактива (опционально)

```bash
python termux_monitor_client.py \
  --source "https://abc123.ngrok-free.app" \
  --token "my-secret-token" \
  --interval 3 \
  --listen-host 127.0.0.1 \
  --listen-port 8088
```

---

## 3) Поток данных (как это работает)

1. ПК-скрипт собирает метрики и отдает `/status` только на `127.0.0.1`.
2. Ваш туннель публикует этот localhost endpoint наружу.
3. Termux-клиент опрашивает внешний адрес туннеля.
4. Termux поднимает **локальный сайт** на телефоне и показывает диаграммы/таблицы.

---

## 4) Советы по безопасности

- Обязательно используйте `--token` на ПК.
- Не публикуйте URL и токен в открытом доступе.
- Если туннель временный — периодически меняйте токен.
